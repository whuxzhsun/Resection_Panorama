  t0 = -((r1*(r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))+r4*(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))+r7*(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH)))/((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9))-1.0/pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9))*(r1*(r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))+r4*(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))+r7*(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))))/(1.0/pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+1.0);
  t0 = -((r2*(r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))+r5*(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))+r8*(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH)))/((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9))-1.0/pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9))*(r2*(r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))+r5*(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))+r8*(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))))/(1.0/pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+1.0);
  t0 = -((r3*(r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))+r6*(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))+r9*(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH)))/((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9))-1.0/pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9))*(r3*(r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))+r6*(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))+r9*(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))))/(1.0/pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+1.0);
  t0 = (((r1*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))-r3*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR)))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))-r6*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR)))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))-r9*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR)))*(-z+zs+dx*r7+dy*r8+dz*r9))/((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9))-((r1*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r3*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR)))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r6*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR)))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r9*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR)))*(-z+zs+dx*r7+dy*r8+dz*r9))*1.0/pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9)))/(1.0/pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+1.0);
  t0 = (((r2*sin(itH)*sin(itP)+r3*cos(itP)*cos(itR)*sin(itH)-r1*cos(itP)*sin(itH)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itH)*sin(itP)+r6*cos(itP)*cos(itR)*sin(itH)-r4*cos(itP)*sin(itH)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itH)*sin(itP)+r9*cos(itP)*cos(itR)*sin(itH)-r7*cos(itP)*sin(itH)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9))/((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9))+((r2*cos(itH)*sin(itP)+r3*cos(itH)*cos(itP)*cos(itR)-r1*cos(itH)*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*cos(itH)*sin(itP)+r6*cos(itH)*cos(itP)*cos(itR)-r4*cos(itH)*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*cos(itH)*sin(itP)+r9*cos(itH)*cos(itP)*cos(itR)-r7*cos(itH)*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9))*1.0/pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9)))/(1.0/pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+1.0);
  t0 = 1.0;

  t0 = -((1.0/sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*((r1*(r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))+r4*(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))+r7*(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH)))*((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9))*2.0+((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9))*(r1*(r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))+r4*(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))+r7*(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP)))*2.0)*(1.0/2.0))/((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9))-sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*1.0/pow((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*(r1*(r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))+r4*(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))+r7*(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))))/((pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*1.0/pow((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+1.0);
  t0 = -((1.0/sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*((r2*(r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))+r5*(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))+r8*(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH)))*((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9))*2.0+((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9))*(r2*(r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))+r5*(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))+r8*(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP)))*2.0)*(1.0/2.0))/((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9))-sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*1.0/pow((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*(r2*(r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))+r5*(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))+r8*(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))))/((pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*1.0/pow((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+1.0);
  t0 = -((1.0/sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*((r3*(r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))+r6*(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))+r9*(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH)))*((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9))*2.0+((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9))*(r3*(r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))+r6*(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))+r9*(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP)))*2.0)*(1.0/2.0))/((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9))-sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*1.0/pow((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*(r3*(r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))+r6*(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))+r9*(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))))/((pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*1.0/pow((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+1.0);
  t0 = (((((r1*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r3*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR)))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r6*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR)))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r9*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR)))*(-z+zs+dx*r7+dy*r8+dz*r9))*((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9))*2.0+((r1*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))-r3*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR)))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))-r6*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR)))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))-r9*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR)))*(-z+zs+dx*r7+dy*r8+dz*r9))*((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9))*2.0)*1.0/sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*(1.0/2.0))/((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9))-sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*((r1*cos(itP)*cos(itR)+r3*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*cos(itP)*cos(itR)+r6*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*cos(itP)*cos(itR)+r9*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9))*1.0/pow((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))/((pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*1.0/pow((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+1.0);
  t0 = (((((r2*sin(itH)*sin(itP)+r3*cos(itP)*cos(itR)*sin(itH)-r1*cos(itP)*sin(itH)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itH)*sin(itP)+r6*cos(itP)*cos(itR)*sin(itH)-r4*cos(itP)*sin(itH)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itH)*sin(itP)+r9*cos(itP)*cos(itR)*sin(itH)-r7*cos(itP)*sin(itH)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9))*((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9))*2.0-((r2*cos(itH)*sin(itP)+r3*cos(itH)*cos(itP)*cos(itR)-r1*cos(itH)*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*cos(itH)*sin(itP)+r6*cos(itH)*cos(itP)*cos(itR)-r4*cos(itH)*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*cos(itH)*sin(itP)+r9*cos(itH)*cos(itP)*cos(itR)-r7*cos(itH)*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9))*((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9))*2.0)*1.0/sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*(1.0/2.0))/((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9))+sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*1.0/pow((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)*((r2*cos(itP)-r3*cos(itR)*sin(itP)+r1*sin(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*cos(itP)-r6*cos(itR)*sin(itP)+r4*sin(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*cos(itP)-r9*cos(itR)*sin(itP)+r7*sin(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9)))/((pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))*1.0/pow((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+1.0);
  t0 = 0.0;

  t0 = -theta_Var-atan(((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9))/((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9)));
  t0 = -psi_Var-atan(sqrt(pow((r1*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r3*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r2*cos(itP)*sin(itH))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r6*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r5*cos(itP)*sin(itH))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itH)*cos(itR)+sin(itH)*sin(itP)*sin(itR))+r9*(cos(itH)*sin(itR)-cos(itR)*sin(itH)*sin(itP))+r8*cos(itP)*sin(itH))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0)+pow((r1*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r3*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r2*cos(itH)*cos(itP))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r4*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r6*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r5*cos(itH)*cos(itP))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r7*(cos(itR)*sin(itH)-cos(itH)*sin(itP)*sin(itR))+r9*(sin(itH)*sin(itR)+cos(itH)*cos(itR)*sin(itP))-r8*cos(itH)*cos(itP))*(-z+zs+dx*r7+dy*r8+dz*r9),2.0))/((r2*sin(itP)+r3*cos(itP)*cos(itR)-r1*cos(itP)*sin(itR))*(-x+xs+dx*r1+dy*r2+dz*r3)+(r5*sin(itP)+r6*cos(itP)*cos(itR)-r4*cos(itP)*sin(itR))*(-y+ys+dx*r4+dy*r5+dz*r6)+(r8*sin(itP)+r9*cos(itP)*cos(itR)-r7*cos(itP)*sin(itR))*(-z+zs+dx*r7+dy*r8+dz*r9)));
